/* generator-yoctopus-test - Utility tool to build an yoctopus stack based on NodeJs / AngularJs - V1.1.0 */
"use strict";var sitemap=require("sitemap"),utils=require("yocto-utils"),_=require("lodash"),path=require("path"),fs=require("fs-extra");exports.trace=function(a,b,c){this.get("logger").debug(["[ Router ] - Receiving a",a.method,"request for",a.originalUrl].join(" ")),c()},exports.index=function(a,b,c){this.get("logger").debug(["[ Router ] - Receiving a",a.method,"request for",a.originalUrl].join(" ")),this.get("render").render(b,"index",{})},exports.robots=function(a,b){var c={};try{if(_.endsWith(a.path,".xml")){b.header("Content-Type","application/xml");var d=sitemap.createSitemap({hostname:utils.request.getHost(a),cacheTime:6e5});c=d.toString(),(_.isNull(c)||_.isEmpty(c))&&(this.get("logger").warning(["Cannot save data for file [",a.path,"] Destination file is invalid or data is empty"].join(" ")),d.add({url:"/"}),c=d.toString())}else{var e=path.normalize([process.cwd(),a.path].join("/"));c=fs.readFileSync(e,"utf-8")}}catch(f){c={},this.get("logger").warning(["Cannot retrieve data for [",a.path,"]. Exception is",f.message].join(" "))}_.endsWith(a.path,".txt")&&b.header("Content-Type","text/plain"),_.endsWith(a.path,".html")&&b.header("Content-Type","text/html"),b.send(c).end()},exports.sitemap=exports.robots,exports.partials=function(a,b){var c=a.originalUrl.replace("/partials","partials");this.get("render").render(b,c,{})};